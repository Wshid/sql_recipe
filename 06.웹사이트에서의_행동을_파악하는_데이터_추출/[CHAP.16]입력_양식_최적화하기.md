# 16. 입력 양식 최적화하기
- 엔트리폼(Entry Form)
  - 자료 청구 양식과 구매 양식 등을 의미
  - 입력 양식
- **입력 양식**의 항목이 너무 많으면
  - 사용자가 **스트레스**를 받아 **이탈률**이 높아짐
- 입력 양식 최적화(EFO, Entry Form Optimization)
  - 위 이탈을 막고, 성과를 높이고자 **입력 양식을 최적화**하는 것

### 입력 양식 최적화의 종류
#### 필수 입력과 선택 입력을 명확하게 구분해서 입력 수를 줄임
- 필수 입력 항목을 위로 올려 배치
#### 오류 발생 빈도를 줄임
- 입력 예를 보여준다
- 제대로 입력하지 않았다고 **실시간**으로 알려준다
#### 쉽게 입력할 수 있게 만든다
- 입력 항목을 줄인다
- 우편번호와 주소 등의 자동 완성 기능을 사용한다
#### 이탈할 만한 요소를 제거한다
- 불필요한 링크를 제거한다(네비게이션 메뉴 단순화 등)
- 실수로 이탈하지 않게
  - 페이지를 벗어날 때, 확인 대화 상자를 띄워 이탈할 것인지, 다시 한번 묻는다

### 유의점 
- 입력 양식 최적화 전에, `어떤 문제가 있는지` 명확하게 파악해야 함
- 입력 양식을 사용하는 동안
  - 사용자가 얼마나 이탈하는지
  - 이를 수정했을 경우, 얼마나 **이탈률 개선**이 이루어지는지
  - **더 개선의 여지가 있는지** 모두 수치화 되어야 함

### 목표
- `EFO 과정` 자체는 물론, `EFO`시 사용하는 대표적인 지표와 리포트
- 기본적으로는 이번 절의 내용으로 각종 집계가 가능하나,
  - 같은 **호칭의 지표**라도, **입력 양식**에 따라 다른 경우도 있음

## 1. 오류율 집계하기
- 개념
  - SQL : `SUM(CASE ~)`, `AVG(CASE ~)`
  - 분석 : 오류율
- **입력 양식** 중에는
  - 발생한 **오류**를, 같은 `URL`에 재출력하여 통지하는 경우가 존재
- 이 경우에는, `URL`만으로는 확인 화면으로의 **이동률 집계가 어려움**
- **확인 화면**으로 이동했을 때
  - `정상 화면`인지, `오류 화면`인지를 집계할 수 있도록 `로그`를 기록
- 로그 데이터에는
  - 오류가 발생했을 때, 페이지 열람 로그에 `error`라는 상태를  출력
  - `stamp, session, action, url, status`
    - `status`에는 에러 여부를 기록

### CODE.16.1 확인 화면에서 오류율을 집계하는 쿼리
- `/confirm` 페이지에서 **오류**가 발생하여, **재입력 화면**을 출력한 경우를 집계
- 분모로 URL이 `/regist/confirm`인 경우를 지정
  - 상태 오류를 `CASE`식을 사용해 **플래그**로 변환 후, 
  - `SUM` 함수와 `AVG`함수로 **오류율 집계 
- `PostgreSQL`, `Hive`, `Redshift`, `BigQuery`, `SparkSQL`
  ```sql
  SELECT
    COUNT(*) AS confirm_count
    , SUM(CASE WHEN status='error' THEN 1 ELSE 0 END) AS error_count
    , AVG(CASE WHEN status='error' THEN 1.0 ELSE 0.0 END) AS error_rate
    , SUM(CASE WHEN status='error' THEN 1.0 ELSE 0.0 END) / COUNT(DISTINCT session) AS error_per_user
  FROM form_log
  WHERE
    -- 확인 화면 페이지 판정
    path = '/regist/confirm'
  ;
  ```

### 원포인트
- **오류율**이 높다면, **오류 통지 방법**에 문제가 있어
  - 사용자가 문제를 이해하지 못해 반복적으로 문제를 발생시키는 경우 일 수 있음
- 이때는, **오류 통지 방법**을 변경할 것